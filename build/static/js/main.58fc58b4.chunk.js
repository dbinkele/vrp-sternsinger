(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{441:function(e,t,n){e.exports=n(534)},446:function(e,t,n){},447:function(e,t,n){},534:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(17),i=n.n(o),c=(n(446),n(447),n(72)),l=(n(557),n(301),n(73)),u=n(153),s=(n(408),n(365));Object(c.a)((function(e){return{appBar:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));n(81);var d=n(539),m=n(537),f=n(560),p=n(366),b=(n(409),n(410),n(573),n(559));Object(c.a)((function(e){return{drawer:{width:240,flexShrink:0},drawerPaper:{width:240,backgroundImage:"linear-gradient(#cfd9df,#e2ebf0)",color:"grey"},bigAvatar:{margin:30,width:100,height:100}}}));Object(c.a)((function(e){return{appBar:{top:"auto",bottom:0,width:"calc(100% - ".concat(240,"px)"),marginLeft:240},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,marginLeft:10},footer:{marginLeft:20,fontSize:17}}}));var g=n(23),h=n(236),v=n.n(h),E=n(414),O=n.n(E),w=n(424),j=n.n(w),x=n(415),T=n.n(x),y=n(422),I=n.n(y),R=n(311),_=n.n(R),C=n(310),k=n.n(C),D=n(416),S=n.n(D),N=n(417),A=n.n(N),P=n(419),V=n.n(P),M=n(420),B=n.n(M),L=n(421),U=n.n(L),q=n(425),z=n.n(q),F=n(418),W=n.n(F),G=n(423),H=n.n(G),J=n(426),$=n.n(J),K=n(27),X=n(292),Z=n(261),Q=n(392),Y={Add:Object(a.forwardRef)((function(e,t){return r.a.createElement(O.a,Object.assign({},e,{ref:t}))})),Check:Object(a.forwardRef)((function(e,t){return r.a.createElement(T.a,Object.assign({},e,{ref:t}))})),Clear:Object(a.forwardRef)((function(e,t){return r.a.createElement(k.a,Object.assign({},e,{ref:t}))})),Delete:Object(a.forwardRef)((function(e,t){return r.a.createElement(S.a,Object.assign({},e,{ref:t}))})),DetailPanel:Object(a.forwardRef)((function(e,t){return r.a.createElement(_.a,Object.assign({},e,{ref:t}))})),Edit:Object(a.forwardRef)((function(e,t){return r.a.createElement(A.a,Object.assign({},e,{ref:t}))})),Export:Object(a.forwardRef)((function(e,t){return r.a.createElement(W.a,Object.assign({},e,{ref:t}))})),Filter:Object(a.forwardRef)((function(e,t){return r.a.createElement(V.a,Object.assign({},e,{ref:t}))})),FirstPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(B.a,Object.assign({},e,{ref:t}))})),LastPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(U.a,Object.assign({},e,{ref:t}))})),NextPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(_.a,Object.assign({},e,{ref:t}))})),PreviousPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(I.a,Object.assign({},e,{ref:t}))})),ResetSearch:Object(a.forwardRef)((function(e,t){return r.a.createElement(k.a,Object.assign({},e,{ref:t}))})),Search:Object(a.forwardRef)((function(e,t){return r.a.createElement(H.a,Object.assign({},e,{ref:t}))})),SortArrow:Object(a.forwardRef)((function(e,t){return r.a.createElement(j.a,Object.assign({},e,{ref:t}))})),ThirdStateCheck:Object(a.forwardRef)((function(e,t){return r.a.createElement(z.a,Object.assign({},e,{ref:t}))})),ViewColumn:Object(a.forwardRef)((function(e,t){return r.a.createElement($.a,Object.assign({},e,{ref:t}))}))},ee=function(e){return e&&""!==e?{isValid:!0}:{isValid:!1,helperText:"Is obligatory"}},te=function(e,t){return e?parseFloat(e).toFixed(t):""},ne=function(e){var t=e.value,n=e.onChange,a=e.error,o=e.helperText;return r.a.createElement(r.a.Fragment,null,r.a.createElement(K.a,{utils:Z.a},r.a.createElement(X.b,{clearable:!0,ampm:!1,emptyLabel:"",value:t||null,onChange:n})),a&&r.a.createElement("p",{style:{color:"red"}},o," "))},ae=[{title:"Postal Code",field:"code",validate:function(e){return function(e){var t=ee(e);return t.isValid?/^\d+$/.test(e)?5!==e.length?{isValid:!1,helperText:"Exactly 5 digits"}:{isValid:!0}:{isValid:!1,helperText:"Only Numbers!"}:t}(e.code)}},{title:"City",field:"city",cwidth:"auto",initialEditValue:" "},{title:"Street",field:"street",cellStyle:{wordBreak:"break-all"},validate:function(e){return ee(e.street)}},{title:"Number",field:"number",type:"numeric",validate:function(e){return function(e){var t=ee(e);return t.isValid?e<=0?{isValid:!1,helperText:"must be greater zero"}:{isValid:!0}:t}(e.number)}},{title:"Name",field:"name",initialEditValue:" "},{title:"Duration Minutes",field:"duration",type:"numeric"},{title:"Hint",field:"hint",initialEditValue:" "}],re=function(e){return ae.concat([{title:"Start Time Window",field:"timewindowstart",type:"datetime",validate:function(t){return le(t,e)},render:function(e){return oe(e.timewindowstart)},editComponent:ne},{title:"End Time Window",field:"timewindowend",type:"datetime",validate:function(t){return ue(t,e)},render:function(e){return oe(e.timewindowend)},editComponent:ne},{title:"Latitude",field:"lat",editable:"never",render:function(e){return te(e.lat,4)}},{title:"Longitude",field:"lon",editable:"never",render:function(e){return te(e.lon,4)}}])},oe=function(e){return null!==e&&e?Q(e).format("hh:mm A"):""};function ie(e){return!("timewindowstart"in e)||null==e.timewindowstart}function ce(e){return!("timewindowend"in e)||null==e.timewindowend}var le=function(e,t){return!ie(e)&&null!=t&&Q(e.timewindowstart).isBefore(Q(t))?{isValid:!1,helperText:"End of time window not after global start time "+Q(t).format("hh:mm A")}:ie(e)&&!ce(e)?{isValid:!1,helperText:"End of time window given, but not start"}:ie(e)||ce(e)||!Q(e.timewindowstart).isAfter(Q(e.timewindowend))?{isValid:!0}:{isValid:!1,helperText:"Start of time window before end"}},ue=function(e,t){return!ce(e)&&null!=t&&Q(e.timewindowend).isBefore(Q(t))?{isValid:!1,helperText:"End of time window not after global start time "+Q(t).format("hh:mm A")}:ce(e)&&!ie(e)?{isValid:!1,helperText:"Start of time window given, but not end"}:ie(e)||ce(e)||!Q(e.timewindowstart).isAfter(Q(e.timewindowend))?{isValid:!0}:{isValid:!1,helperText:"Start of time window before end"}},se=n(19),de=n(572),me=function(){console.log("NODE_ENV production");var e="http://"+Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_HEROKU_APP_NAME+".herokuapp.com";return console.log("Url "+e),e};function fe(e,t){return e.filter((function(e){return-1===t.indexOf(e)}))}function pe(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))}n(505);var be,ge,he=n(34),ve=n(427),Ee=n.n(ve),Oe=n(30),we=n(570),je=Object(we.a)((be={},Object(Oe.a)(be,"REFRESH",(function(e,t){return{tourItems:t.payload}})),Object(Oe.a)(be,"ADD_TOUR_ITEM",(function(e,t){return null==e.tourItems?{tourItems:[t.payload]}:{tourItems:[].concat(Object(se.a)(e.tourItems),[t.payload])}})),Object(Oe.a)(be,"REMOVE_TOUR_ITEM",(function(e,t){var n=t.payload;return{tourItems:[].concat(Object(se.a)(e.tourItems.slice(0,n)),Object(se.a)(e.tourItems.slice(n+1)))}})),Object(Oe.a)(be,"UPDATE_TOUR_ITEM",(function(e,t){var n=t.payload,a=n.item,r=n.index;return{tourItems:[].concat(Object(se.a)(e.tourItems.slice(0,r)),[a],Object(se.a)(e.tourItems.slice(r+1)))}})),be),{tourItems:[]}),xe=n(97),Te=n(432),ye=n(129),Ie=function(){var e=Object(he.c)(),t=Object(a.createRef)(),n=Object(a.useCallback)((function(t){var n=new FileReader;n.onloadend=function(t){var a=n.result;console.log("-------\x3e result"),console.log(a),e({type:"REFRESH",payload:JSON.parse(a)})},n.readAsText(t[0])}),[]),o=Object(Te.a)({onDrop:n,accept:"application/json",minSize:0,maxSize:1048576}),i=o.isDragActive,c=o.getRootProps,l=o.getInputProps,u=o.isDragReject,s=(o.acceptedFiles,o.rejectedFiles),d=!!s&&s.length>0&&s[0].size>1048576;return r.a.createElement("div",{className:"upload-dropzone"},r.a.createElement("div",c(),r.a.createElement("input",l()),r.a.createElement("p",null,!i&&"Click here or drop a file to upload!",i&&!u&&"Drop it like it's hot!",u&&"File type not accepted, sorry!",d&&r.a.createElement("div",{className:"text-danger mt-2"},"File is too large.")),r.a.createElement(ye.a,{color:"secondary",variant:"outlined",onClick:function(){t.current&&t.current.open()}},"Open File Dialog")))},Re=function(e,t,n){var a="https://nominatim.openstreetmap.org/search?format=json&country=de&postalcode=".concat(e.code,"&street=").concat(e.number,"+").concat(e.street);Ee.a.get(a,{timeout:5e3}).then((function(e){return e.data})).then((function(a){if(a.length>0){var r=a[0];if(null!=r.lat&&null!=r.lon)return e.lat=r.lat,e.lon=r.lon,void t()}n("Wrong Address!")})).catch((function(e){e.response?n("Bad Response  "+e):e.request?n("No Response  "+e):n("Unspecified Error  "+e)}))},_e=function(e){var t=Object(xe.useSnackbar)().enqueueSnackbar,n=Object(he.c)(),a=Object(he.d)((function(e){return e.tourItemsReducer.tourItems})),o=e.startTime;return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{options:{paging:!1},icons:Y,title:"Tour Items",columns:re(o),data:a,editable:{onRowAdd:function(e){return new Promise((function(a,r){setTimeout((function(){Re(e,(function(){e.id=Object(de.a)().replace(/^(.{8})-(.{4})-(.{4})/,"$3-$2-$1"),e.label=e.code+"/"+e.street+". "+e.number,e.label+=e.name?"/"+e.name:"",n({type:"ADD_TOUR_ITEM",payload:e}),a()}),(function(e){t(e,{variant:"error"}),r(e)}))}),10)}))},onRowUpdate:function(e,a){return new Promise((function(r,o){setTimeout((function(){Re(e,(function(){var t=a.tableData.id;n(function(e,t){return{type:"UPDATE_TOUR_ITEM",payload:{item:e,index:t}}}(e,t)),r()}),(function(e){t(e,{variant:"error"}),o(e)}))}),10)}))},onRowDelete:function(e){return new Promise((function(t,a){setTimeout((function(){var a=e.tableData.id;n(function(e){return{type:"REMOVE_TOUR_ITEM",payload:e}}(a)),t()}),10)}))}}}),r.a.createElement(Ie,null))},Ce=n(40),ke=n.n(Ce),De=n(89),Se=n(56),Ne=n(163),Ae=(n(533),Object(a.memo)((function(e){return r.a.createElement(b.a,{container:!0},r.a.createElement(b.a,{xs:2,md:1,item:!0},r.a.createElement(ye.a,{fullWidth:!0,color:"secondary",variant:"outlined",onClick:e.onButtonClick},"Add")))}))),Pe=n(403),Ve=n(568),Me=n(430),Be=n.n(Me),Le=n(116),Ue=n(569),qe=Object(c.a)((function(e){return{root:{margin:"auto"},paper:{width:200,height:230,overflow:"auto"},button:{margin:e.spacing(.5,0)}}})),ze=function(e){var t=e.left,n=e.right,a=e.handleAllRight,o=e.handleCheckedRight,i=e.handleCheckedLeft,c=e.handleAllLeft,l=qe(),u=r.a.useState([]),s=Object(g.a)(u,2),h=s[0],v=s[1],E=pe(h,t),O=pe(h,n),w=function(e){return function(){var t=h.indexOf(e),n=Object(se.a)(h);-1===t?n.push(e):n.splice(t,1),v(n)}},j=function(e,t){return r.a.createElement(Le.a,{style:{width:"200px",height:"200px",maxHeight:"unset",maxWidth:"unset",overflow:"auto"},className:l.paper},r.a.createElement(d.a,{style:{width:"100%"},component:"div",role:"list",subheader:r.a.createElement(Ue.a,{component:"div",id:"nested-list-subheader"},t)},e.map((function(e){var t=e.id;return r.a.createElement(m.a,{key:t,role:"listitem",button:!0,onClick:w(e)},r.a.createElement(f.a,null,r.a.createElement(Pe.a,{checked:-1!==h.indexOf(e),tabIndex:-1,disableRipple:!0,inputProps:{"aria-labelledby":t}})),r.a.createElement(p.a,{id:t,primary:e.label}))})),r.a.createElement(m.a,null)))};return r.a.createElement(b.a,{container:!0,direction:"row",className:l.root},r.a.createElement(b.a,{item:!0},j(t,"Available")),r.a.createElement(b.a,{item:!0},r.a.createElement(b.a,{container:!0,direction:"column"},r.a.createElement(ye.a,{variant:"outlined",size:"small",className:l.button,onClick:a,disabled:0===t.length,"aria-label":"move all right"},"\u226b"),r.a.createElement(ye.a,{variant:"outlined",size:"small",className:l.button,onClick:function(){o(E),v(fe(h,E))},disabled:0===E.length,"aria-label":"move selected right"},">"),r.a.createElement(ye.a,{variant:"outlined",size:"small",className:l.button,onClick:function(){i(O),v(fe(h,O))},disabled:0===O.length,"aria-label":"move selected left"},"<"),r.a.createElement(ye.a,{variant:"outlined",size:"small",className:l.button,onClick:c,disabled:0===n.length,"aria-label":"move all left"},"\u226a"))),r.a.createElement(b.a,{item:!0},j(n,"Selected")))},Fe=n(406),We=n(429),Ge=n.n(We),He=n(191),Je=Object(c.a)((function(e){return{root:{display:"flex",justifyContent:"center",flexWrap:"wrap",listStyle:"none",padding:e.spacing(.5),margin:0},chip:{margin:e.spacing(.5)}}})),$e=function(e){var t=e.tourItems,n=e.moveConstraints,a=Je(),o=Object(He.b)((function(e){var t=e.item;return r.a.createElement(m.a,{key:t.id,button:!0},r.a.createElement(Fe.a,{size:"small",icon:r.a.createElement(Ge.a,null),label:t.label,className:a.chip}))})),i=Object(He.a)((function(e){var t=e.items;return r.a.createElement(d.a,{component:"div",className:"topContainer",width:"100%"},t.map((function(e,t){return r.a.createElement(o,{key:"item-".concat(e.id),index:t,item:e})})))}));return r.a.createElement(i,{items:t,onSortEnd:n})},Ke=function(e,t){return function(n){var a=n.oldIndex,r=n.newIndex;t(Object(He.c)(Object(se.a)(e),a,r))}},Xe=function(e){var t=e.selected,n=e.constraints,a=e.globalConstraint,o=e.setGlobalConstraint,i=e.setConsts,c=e.addConst,l=Object(he.d)((function(e){return e.tourItemsReducer.tourItems})),u=r.a.useState([]),s=Object(g.a)(u,2),d=s[0],m=s[1],f=fe(l,a),p=r.a.useState(f),b=Object(g.a)(p,2),h=b[0],v=b[1],E=fe(f,h.concat(n)),O=pe(h,f).concat(E),w=pe(n,l);return t?r.a.createElement(ze,{left:O,right:w,handleAllLeft:function(){v(h.concat(d)),m([]),o((function(e){return fe(e,d)})),i([])},handleAllRight:function(){var e=d.concat(h);m(e),i(e),o((function(e){return e.concat(h)})),v([])},handleCheckedLeft:function(e){v(h.concat(e));var t=fe(d,e);m(t),o((function(t){return fe(t,e)})),i(t)},handleCheckedRight:function(e){var t=d.concat(e);m(t),c(e),o((function(t){return t.concat(e)})),v(fe(h,e))}}):r.a.createElement($e,{tourItems:w,moveConstraints:Ke(n,i)})},Ze=Object(a.memo)((function(e){var t=e.selected,n=e.constraints,a=e.globalConstraint,o=e.setGlobalConstraint,i=e.addConst,c=e.setConsts,l=e.onButtonClick;return r.a.createElement(m.a,{divider:e.divider,ContainerComponent:"div"},r.a.createElement(f.a,null,r.a.createElement(Pe.a,{onClick:e.onCheckBoxToggle,checked:t,disableRipple:!0})),r.a.createElement(p.a,null,r.a.createElement(Xe,Object(Se.a)({},{selected:t,constraints:n,globalConstraint:a,setGlobalConstraint:o,addConst:i,setConsts:c}))),r.a.createElement(Ve.a,{component:"div"},r.a.createElement(u.a,{"aria-label":"Delete Todo",onClick:l},r.a.createElement(Be.a,null))))})),Qe=n(262),Ye=n.n(Qe);function et(e,t,n){return{todos:[].concat(Object(se.a)(e.todos.slice(0,t)),[n],Object(se.a)(e.todos.slice(t+1)))}}var tt=Object(we.a)((ge={},Object(Oe.a)(ge,"ADD_TODO_ITEM",(function(e,t){var n=t.payload.toDoIdx,a=e.todos[n].concat({checked:!1,constraints:[]});return et(e,n,a)})),Object(Oe.a)(ge,"REMOVE_TODO_ITEM",(function(e,t){var n=t.payload,a=n.toDoIdx,r=n.index,o=e.todos[a].filter((function(e,t){return r!==t}));return et(e,a,o)})),Object(Oe.a)(ge,"POP_TODO_ITEM",(function(e,t){var n=t.payload.toDoIdx,a=e.todos[n].length-1,r=e.todos[n].filter((function(e,t){return a!==t}));return et(e,n,r)})),Object(Oe.a)(ge,"UPDATE_TODO_ITEM",(function(e,t){var n=t.payload,a=n.toDoIdx,r=n.index;return et(e,a,nt(e,a,r))})),Object(Oe.a)(ge,"ADD_CONSTRAINT_ITEM",(function(e,t){var n=t.payload,a=n.toDoIdx,r=n.constraint,o=n.constrIdx,i=e.todos[a];return et(e,a,[].concat(Object(se.a)(i.slice(0,o)),[{checked:i[o].checked,constraints:i[o].constraints.concat(r)}],Object(se.a)(i.slice(o+1))))})),Object(Oe.a)(ge,"SEt_CONSTRAINT_ITEM",(function(e,t){var n=t.payload,a=n.toDoIdx,r=n.constraints,o=n.constrIdx,i=e.todos[a];return et(e,a,[].concat(Object(se.a)(i.slice(0,o)),[{checked:i[o].checked,constraints:r}],Object(se.a)(i.slice(o+1))))})),ge),{todos:[[],[],[],[]]}),nt=function(e,t,n){return e.todos[t].map((function(e,t){return n!==t&&e.checked?{checked:!1,constraints:e.constraints}:n===t?{checked:!e.checked,constraints:e.constraints}:e}))},at=Ye()((function(e){return{root:{width:"100%",minWidth:"1200px",overflow:"scroll",padding:"0 0px",color:"white"}}})),rt=Object(a.memo)((function(e){var t=at(),n=e.todoIdx,a=e.globalConstraint,o=e.setGlobalConstraint,i=e.onItemRemove,c=e.onItemCheck,l=Object(he.c)(),u=Object(he.d)((function(e){return e.todoReducer.todos[n]}));return r.a.createElement(r.a.Fragment,null,u.length>0&&r.a.createElement(d.a,{className:t.root,component:"div"},u.map((function(e,t){return r.a.createElement(Ze,Object.assign({globalConstraint:a,setGlobalConstraint:o,addConst:function(e){return l({type:"ADD_CONSTRAINT_ITEM",payload:{toDoIdx:n,constraint:e,constrIdx:t}})},setConsts:function(e){return l({type:"SEt_CONSTRAINT_ITEM",payload:{toDoIdx:n,constraints:e,constrIdx:t}})},selected:u[t].checked,constraints:u[t].constraints},{key:"TodoItem.".concat(t),divider:t!==u.length-1,onButtonClick:function(){return i(t)},onCheckBoxToggle:function(){return c(t)}}))}))))})),ot=Ye()((function(e){return{root:{width:"100%"}}})),it=Object(a.memo)((function(e){var t=e.todoIdx,n=e.maxToDo,o=r.a.useState([]),i=Object(g.a)(o,2),c=i[0],l=i[1],u=Object(xe.useSnackbar)().enqueueSnackbar,s=Object(he.c)(),d=Object(he.d)((function(e){return e.todoReducer.todos[t]})),m=ot(),f={todoIdx:t,globalConstraint:c,setGlobalConstraint:l};return Object(a.useEffect)((function(){for(var e=Number(n),a=d.length-e,r=0;r<a;r++)s({type:"POP_TODO_ITEM",payload:{toDoIdx:t}})}),[n,d.length,t,s]),r.a.createElement(b.a,{container:!0,direction:"column",justify:"space-evenly",alignItems:"flex-start",className:m.root},r.a.createElement(b.a,{item:!0,xs:12},r.a.createElement(Ae,{onButtonClick:function(){var e=Number(n);d.length>=e?u(e+" vehicles can cover only "+e+" tours",{variant:"error"}):s({type:"ADD_TODO_ITEM",payload:{toDoIdx:t}})}})),r.a.createElement(b.a,{item:!0,xs:12},r.a.createElement(rt,Object.assign({},Object(Se.a)({},f),{onItemCheck:function(e){return s({type:"UPDATE_TODO_ITEM",payload:{index:e,toDoIdx:t}})},onItemRemove:function(e){s({type:"REMOVE_TODO_ITEM",payload:{index:e,toDoIdx:t}})}}))))})),ct=n(241),lt=n(308),ut=n(303),st=n(304),dt=function(e){var t=e.register,n=e.errors,o=e.control,i=Object(xe.useSnackbar)().enqueueSnackbar,c=Object(he.d)((function(e){return e.tourItemsReducer.tourItems})),l=function(e){void 0!==e&&i(e,{variant:"error",preventDuplicate:!0})};return Object(a.useEffect)((function(){var e,t,a,r,o,i,c,u,s;l(null===n||void 0===n||null===(e=n.email)||void 0===e?void 0:e.message),l(null===n||void 0===n||null===(t=n.timeout)||void 0===t?void 0:t.message),l(null===n||void 0===n||null===(a=n.vehicles)||void 0===a?void 0:a.message),l(null===n||void 0===n||null===(r=n.defaultDuration)||void 0===r?void 0:r.message),l(null===n||void 0===n||null===(o=n.weight_visits)||void 0===o?void 0:o.message),l(null===n||void 0===n||null===(i=n.weight_length)||void 0===i?void 0:i.message),l(null===n||void 0===n||null===(c=n.depot)||void 0===c?void 0:c.message),l(null===n||void 0===n||null===(u=n.starttime)||void 0===u?void 0:u.message),l(null===(s=n.planningType)||void 0===s?void 0:s.message)}),[n.email,n.timeout,n.vehicles,n.defaultDuration,n.weight_visits,n.weight_length,n.depot,n.starttime,n.planningType,n]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ut.a,{style:{minWidth:300},error:Boolean(n.depot)},r.a.createElement(st.a,{id:"demo-simple-select-label"},"Select Start Location"),r.a.createElement(Ne.a,{as:r.a.createElement(lt.a,null,c.map((function(e){return r.a.createElement(s.a,{key:e.id,value:e.id},e.code,"/",e.street,"/",e.number,"/",e.name)}))),name:"depot",rules:{required:"Start Location is required"},control:o})),r.a.createElement(Ne.a,{name:"starttime",control:o,render:function(e){var t=e.onChange,a=e.value;return r.a.createElement(K.a,{utils:Z.a},r.a.createElement(X.b,{clearable:!0,ampm:!1,label:"Select Start Time",value:a||null,onChange:t,error:Boolean(n.starttime)}))},rules:{required:"Start Time is required"}}),r.a.createElement(ut.a,{style:{minWidth:120},error:Boolean(n.planningType)},r.a.createElement(st.a,{id:"demo-simple-select-label"},"Select a Planning Type"),r.a.createElement(Ne.a,{as:r.a.createElement(lt.a,null,r.a.createElement(s.a,{key:"foot",value:"foot"},"foot"),r.a.createElement(s.a,{key:"car",value:"car"},"car")),name:"planningType",rules:{required:"Planning Type is required"},control:o,defaultValue:"car"})),r.a.createElement(ct.a,{id:"email",label:"Email address",type:"email",name:"email",autoComplete:"email",margin:"normal",variant:"outlined",error:!!n.email,inputRef:t({required:"Email is mandatory!",pattern:{value:/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,message:"Must be a valid email"}})}),r.a.createElement(ct.a,{id:"timeout",label:"Timout Minutes",type:"number",name:"timeout",margin:"normal",variant:"outlined",defaultValue:1,error:!!n.timeout,inputRef:t({required:"Please specify Timeout",min:{value:1,message:"Timeout must be at least 1."},max:{value:10,message:"Timeout can be at most 10."}})}),r.a.createElement(ct.a,{id:"vehicles",label:"Number of Vehicles",type:"number",name:"vehicles",margin:"normal",variant:"outlined",defaultValue:1,error:!!n.vehicles,inputRef:t({required:"Please specify Number of Vehicles",min:{value:1,message:"At lest one vehicle is required."},max:{value:20,message:"More than 20 vehicles not supported."}})}),r.a.createElement(ct.a,{id:"defaultDuration",label:"Default Duration Minutes",type:"number",name:"defaultDuration",margin:"normal",variant:"outlined",defaultValue:1,error:!!n.defaultDuration,inputRef:t({required:"Please specify Timeout",min:{value:0,message:"Must be greater zero."}})}),r.a.createElement(ct.a,{id:"weight_visits",label:"Importance of Tour Length Equality",type:"number",name:"weight_visits",margin:"normal",variant:"outlined",defaultValue:1,error:!!n.weight_visits,inputRef:t({required:"Please specify Importance",min:{value:0,message:"Must be greater zero."},max:{value:100,message:"More than 100 not supported."}})}),r.a.createElement(ct.a,{id:"weight_lenght",label:"Importance of Total Time Travelled",type:"number",name:"weight_length",margin:"normal",variant:"outlined",defaultValue:1,error:!!n.weight_length,inputRef:t({required:"Please specify Importance",min:{value:0,message:"Must be greater zero."},max:{value:100,message:"More than 100 not supported."}})}))},mt=n(565),ft=n(567),pt=n(431),bt=n.n(pt),gt=n(566),ht=Object(c.a)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary}}})),vt=function(e){var t=e.panel,n=e.component,a=e.heading,o=e.details,i=e.expanded,c=e.setExpanded,u=ht(),s=t+"bh-content",d=t+"bh-header";return r.a.createElement(mt.a,{expanded:i===t,onChange:function(e){return function(t,n){c(!!n&&e)}}(t)},r.a.createElement(ft.a,{expandIcon:r.a.createElement(bt.a,null),"aria-controls":s,id:d},r.a.createElement(l.a,{className:u.heading},a),r.a.createElement(l.a,{className:u.secondaryHeading},o)),r.a.createElement(gt.a,null,n))},Et=n(392),Ot=Object(c.a)((function(e){return{root:{width:"100%"}}})),wt=function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch(me()+"vrp",t).then(function(){var e=Object(De.a)(ke.a.mark((function e(t){var n,a;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(n=e.sent,t.ok){e.next=6;break}return a=n&&n.message||t.status,e.abrupt("return",Promise.reject(a));case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};function jt(e,t,n){return e.todoReducer.todos[n].map((function(e){return e.constraints})).map((function(e){return e.map((function(e){return e.id})).map((function(e){return t.indexOf(e)}))}))}var xt=function(){var e=Object(De.a)(ke.a.mark((function e(t,n,a){var r,o,i;return ke.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:if(e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return r=n(),o=a.tourItemsReducer.tourItems.map((function(e){return e.id})),i={recipent:r.email,data:a.tourItemsReducer.tourItems,constraints:{num_visits_to_max_tour_len_ration:[Number(r.weight_visits),Number(r.weight_length)],timeout:60*Number(r.timeout),depot:o.indexOf(r.depot),planningType:r.planningType,num_vehicles:Number(r.vehicles),duration:Number(r.defaultDuration),fixed_arcs:[],assign_to_route:jt(a,o,0),same_route:jt(a,o,1),same_route_ordered:jt(a,o,2),different_route:jt(a,o,3),dwell_duration:Tt(a,o,r.defaultDuration),time_windows:It(a,o,r.starttime)}},console.log(i),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();var Tt=function(e,t,n){return e.tourItemsReducer.tourItems.filter((function(e){return e.hasOwnProperty("duration")})).map((function(e){return{id:t.indexOf(e.id),duration:60*e.duration}})).concat([{id:-1,duration:60*Number(n)}])};function yt(e,t){return Math.round(Et.duration(Et(e).diff(t)).asMinutes())}var It=function(e,t,n){return e.tourItemsReducer.tourItems.filter((function(e){return e.hasOwnProperty("timewindowstart")&&e.hasOwnProperty("timewindowend")})).filter((function(e){return null!==e.timewindowstart&&null!=e.timewindowend})).map((function(e){return{id:t.indexOf(e.id),interval:[yt(e.timewindowstart,n),yt(e.timewindowend,n)]}})).concat([{id:0,interval:[0,0]}])},Rt=function(e){var t=e.setStartTime,n=Object(he.d)((function(e){return e})),o=Object(xe.useSnackbar)().enqueueSnackbar,i=Object(Ne.b)({mode:"onChange",defaultValues:{depot:"",email:"",timeout:3,vehicles:1,defaultDuration:1,weight_visits:1,weight_lenght:1}}),c=i.register,l=i.errors,u=i.watch,s=i.getValues,d=i.trigger,m=i.control,f=u("vehicles",1),p=u("starttime"),b=Ot(),h=r.a.useState(!1),v=Object(g.a)(h,2),E=v[0],O=v[1];Object(a.useEffect)((function(){t((function(e){return p}))}),[p]);return r.a.createElement(a.Fragment,null,r.a.createElement("div",{className:b.root},r.a.createElement(vt,{panel:"panel1",component:r.a.createElement(dt,{register:c,errors:l,control:m}),heading:"General Settings",details:"Basic Driver Values for the algorithm",expanded:E,setExpanded:O}),r.a.createElement(vt,{panel:"panel2",component:r.a.createElement(it,Object(Se.a)(Object(Se.a)({},e),{todoIdx:0,maxToDo:f})),heading:"Tour Assignment",details:"Tour Items must be an the nth tour",expanded:E,setExpanded:O}),r.a.createElement(vt,{panel:"panel3",component:r.a.createElement(it,Object(Se.a)(Object(Se.a)({},e),{todoIdx:1,maxToDo:Number.MAX_VALUE})),heading:"Tour Constraints",details:"Tour Items  on the same tour in arbitrary order",expanded:E,setExpanded:O}),r.a.createElement(vt,{panel:"panel4",component:r.a.createElement(it,Object(Se.a)(Object(Se.a)({},e),{todoIdx:2,maxToDo:Number.MAX_VALUE})),heading:"Tour Constraints Ordered",details:"Tour Items on the same tour in given order",expanded:E,setExpanded:O}),r.a.createElement(vt,{panel:"panel5",component:r.a.createElement(it,Object(Se.a)(Object(Se.a)({},e),{todoIdx:3,maxToDo:Number.MAX_VALUE})),heading:"Tour Constraints Different",details:"Tour Items that must be on different routes",expanded:E,setExpanded:O})),r.a.createElement(ye.a,{color:"secondary",variant:"outlined",onClick:function(){n.tourItemsReducer.tourItems.length<=1?o("There must be more than one tour item!",{variant:"error"}):xt(d,s,n).then((function(e){null!==e&&wt(e).then((function(e){o("Successful submitted! Job ID "+e.id+" Job Status: "+e.status,{variant:"info"})})).catch((function(e){o(e.message,{variant:"error"})}))}))}},"Submit"),r.a.createElement(ye.a,{color:"secondary",variant:"outlined",onClick:function(){n.tourItemsReducer.tourItems.length>0?function(e){var t=document.createElement("a"),n=new Blob([JSON.stringify(e)],{type:"text/plain"});t.href=URL.createObjectURL(n),t.download="touritems.json",t.click()}(n.tourItemsReducer.tourItems):o("There must be at least one tour item!",{variant:"warning"})}},"Download"))},_t=(Object(a.createContext)(""),Object(c.a)((function(e){return{toolbar:e.mixins.toolbar,title:{flexGrow:1,backgroundColor:e.palette.background.default,padding:e.spacing(3)},content:{flexGrow:1,padding:e.spacing(3)},fullWidth:{width:"100%"}}})));var Ct=function(){var e=_t(),t=Object(a.useState)(null),n=Object(g.a)(t,2),o=n[0],i=n[1];return r.a.createElement("main",{className:e.fullWidth},r.a.createElement("div",{className:e.toolbar}),r.a.createElement("div",{className:e.title},r.a.createElement(l.a,{variant:"h6"},"Tour Planning")),r.a.createElement("div",{className:e.content},r.a.createElement(xe.SnackbarProvider,{maxSnack:3},r.a.createElement(_e,{startTime:o}),r.a.createElement(Rt,{setStartTime:i}))))},kt=Object(c.a)((function(e){return{root:{display:"flex"}}}));var Dt=function(){var e=kt();return r.a.createElement("div",{className:e.root},r.a.createElement(Ct,null))};var St=function(){return r.a.createElement(Dt,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Nt=n(80),At=Object(we.a)(Object(Oe.a)({},"SET_DEPOT",(function(e,t){var n=t.payload.id;return Object(Se.a)(Object(Se.a)({},e),{},{depot:n})})),{depot:"",email:"",timeout:3,vehicles:1,duration:1,weight_visits:1,weight_lenght:1}),Pt=Object(Nt.c)({tourItemsReducer:je,todoReducer:tt,settingsReducer:At});i.a.render(r.a.createElement(he.a,{store:Object(Nt.e)(Pt)},r.a.createElement(St,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[441,1,2]]]);
//# sourceMappingURL=main.58fc58b4.chunk.js.map